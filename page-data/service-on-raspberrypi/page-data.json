{"componentChunkName":"component---src-templates-blog-post-js","path":"/service-on-raspberrypi/","result":{"data":{"site":{"siteMetadata":{"title":"PPX Blog"}},"markdownRemark":{"id":"c390b0da-b06e-5da8-995f-61556d91a7cd","excerpt":"Prepare the Raspberry Pi install the Raspberry Pi os into the microSD card, setup the username/password before write into card power on the Pi and plug in the…","html":"<h2>Prepare the Raspberry Pi</h2>\n<ol>\n<li>install the Raspberry Pi os into the microSD card, setup the username/password before write into card</li>\n<li>power on the Pi and plug in the network cable</li>\n<li>get the ip address of the Pi through the router admin page</li>\n<li>on another machine ssh into the Pi</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ssh pi@&lt;ip address of pi&gt;</code></pre></div>\n<ol start=\"5\">\n<li>enable tcp forwarding for ssh(if you want to use vscode to remote work on it)</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo vim /etc/ssh/sshd_config\n\n# Change AllowTcpForwarding to yes</code></pre></div>\n<h2>Write a service using express and nodeJS</h2>\n<ol>\n<li>prepare the work space</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mkdir dev\ncd dev\nnpm init -y\nnpm install express\ntouch server.js</code></pre></div>\n<ol start=\"2\">\n<li>write the welcome service</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># in server.js\nconst express = require(&quot;express&quot;);\nconst app = express();\n\napp.get(&quot;/&quot;, (req, res) =&gt; {\n  res.send(`\n    &lt;!DOCTYPE html&gt;\n    &lt;html&gt;\n      &lt;body&gt;\n        &lt;h1&gt;Welcome&lt;/h1&gt;\n      &lt;/body&gt;\n    &lt;/html&gt;\n  );\n});\n\napp.listen(5000, () =&gt; {console.log(`http://localhost:5000`)});</code></pre></div>\n<ol start=\"3\">\n<li>run the service and we should be able to see the welcome page on any machine’s browser using the ip address</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">node server.js\n# open browser on any machine under the same wifi network of the Pi and enter the ip address of the Pi and port 5000 in address bar of the browser.\n# e.g., 192.168.1.75:5000\n# You should be able to see a welcome page.</code></pre></div>\n<h2>Replace the Nodejs server with the Nginx server</h2>\n<ol>\n<li>install Nginx</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt install nginx</code></pre></div>\n<ol start=\"2\">\n<li>set up the reverse proxy, by enabling the reverse proxy, we added a layer between nodeJS server and the client side to realize the load balance</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo vim /etc/nginx/sites-available/default\n# in the default file, add one line (proxy_pass) to the location / section\n\nlocation / {\n          proxy_pass http://localhost:5000;\n          try_files $uri $uri/ =404;\n}</code></pre></div>\n<ol start=\"3\">\n<li>now if we use any browser under the same wifi network to access the ip address, we can see the welcome page. All the request going to the ip will be handled by Nginx and be sent to localhost:5000 then.</li>\n</ol>\n<h2></h2>","frontmatter":{"title":"A web service deployed on Raspberry Pi based on Nginx","date":"March 23, 2022","description":"Use Raspberry Pi to deploy a Nginx web service","tags":["web","deployment"]}}},"pageContext":{"slug":"/service-on-raspberrypi/","previous":{"fields":{"slug":"/mongodb-install-issue/"},"frontmatter":{"title":"在m1安装mongodb遇到的一些坑","tags":["database","env setup"]}},"next":{"fields":{"slug":"/Docker-with-postgres/"},"frontmatter":{"title":"Using Docker with Postgres","tags":["database","Docker"]}}}},"staticQueryHashes":["2841359383","3723978383"]}