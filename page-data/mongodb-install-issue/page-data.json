{"componentChunkName":"component---src-templates-blog-post-js","path":"/mongodb-install-issue/","result":{"data":{"site":{"siteMetadata":{"title":"PPX Blog"}},"markdownRemark":{"id":"340aa628-481a-581a-8261-7ffcc0f8012b","excerpt":"安装流程 install home brew    坑 Two ways to start service 根据mongodb文档, step 3和step 4中间还有一步 .  我们首先需要知道mongodb有两部分构成, server和client. 开启server的命令为 , 开启client…","html":"<h2>安装流程</h2>\n<ol>\n<li>install home brew</li>\n<li><code class=\"language-text\">brew tap mongodb/brew</code></li>\n<li><code class=\"language-text\">brew install mongodb-community@5.0</code></li>\n<li><code class=\"language-text\">brew services list</code></li>\n</ol>\n<h2>坑</h2>\n<h3>Two ways to start service</h3>\n<p>根据<a href=\"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/\">mongodb文档</a>, step 3和step 4中间还有一步 <code class=\"language-text\">brew services start mongodb-community@5.0</code>. </p>\n<p>我们首先需要知道mongodb有两部分构成, server和client. 开启server的命令为 <code class=\"language-text\">mongod (other parameters...)</code>, 开启client的命令为<code class=\"language-text\">mongo</code>. </p>\n<p>而官网所说的<code class=\"language-text\">brew services start mongodb-community@5.0</code> 其实会直接运行default mongod command. 而默认的server db存储位置为<code class=\"language-text\">/data/db</code>.  <code class=\"language-text\">/</code> 是mac的read-only space, 我们不可以在这里mkdir, 而他本来就没有/data/db这个folder, 所以我们运行官网给出的<code class=\"language-text\">brew services start mongodb-community@5.0</code> 后再运行 <code class=\"language-text\">brew services list</code> 就会显示 3584 error.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e464eb4b23519c39af0c037bddccc085/8efc2/error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKElEQVQY0z2Q207CQBiE+wxAz90ewFpIhAi2WMqhSBE5KQlc+Bhe+lo+ij6M15+7JfFispM/M//Mv9rv9zs/Xyf8XoT/2MN7iIl7CWW55G4wIJ9MmM7ntDsdxnlOXhT4QYBl29iOc4V7fS0J7fPjxPmQYdgWTiBwQg9XeIRRhCdEbQ7CEMd15VxgWhYtXafZatXckGhIrhuGXGijVZsjt90+jWYTy7IxTSkyzVqgxIoro4LreYzSlMHwnlGW1kE3cUw2HpN0u3VL7XI5k0qRaqIgfJ+w3f7nyqSEpjxRNV4UU9blE/vnF5IkqRcdjkdm8lsi6dPmZclmu2W3P5BmGcVsxuvbiVVVkcrkVbWuzzcsE+G4DI2Avi4Y6j4NeboKVq0XyyXb3Z4/89aVW7+m22gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"error\"\n        title=\"error\"\n        src=\"/static/e464eb4b23519c39af0c037bddccc085/fcda8/error.png\"\n        srcset=\"/static/e464eb4b23519c39af0c037bddccc085/12f09/error.png 148w,\n/static/e464eb4b23519c39af0c037bddccc085/e4a3f/error.png 295w,\n/static/e464eb4b23519c39af0c037bddccc085/fcda8/error.png 590w,\n/static/e464eb4b23519c39af0c037bddccc085/8efc2/error.png 828w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Fail to stop service</h3>\n<p>当使用<code class=\"language-text\">brew services start mongodb-community@5.0</code> 时我们可以用 <code class=\"language-text\">brew services stop mongodb-community@5.0</code> 停止server.</p>\n<p>当使用 <code class=\"language-text\">mongod (other parameters..)</code>时我们有两种方法停止server.</p>\n<ul>\n<li>Ctrl+C on the terminal which is running mongod</li>\n<li>\n<p>open a new terminal</p>\n<ul>\n<li>type <code class=\"language-text\">mongo</code> and hit enter</li>\n<li><code class=\"language-text\">use admin</code></li>\n<li><code class=\"language-text\">db.shutdownServer()</code></li>\n</ul>\n</li>\n</ul>\n<h2>填坑</h2>\n<p>很简单, 不使用brew services start即可. 我们可以使用<code class=\"language-text\">sudo mkdir -p /System/Volumes/Data/data/db</code> 在可写区域创建好db储存的文件夹. 然后用<code class=\"language-text\">sudo mongod --dbpath /System/Volumes/Data/data/db</code> 指定server运行时的数据位置. 这时使用<code class=\"language-text\">brew services list</code> 则会显示service status started. 之后就可以打开另一个terminal开启client了!</p>\n<p>注意: 在做这些事前请确保没有正在运行的mongod(server service).</p>\n<h2>卸载流程</h2>\n<ol>\n<li><code class=\"language-text\">launchctl list | grep mongo</code> to check the running mongo service</li>\n<li><code class=\"language-text\">launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist</code> based on which file exists in <code class=\"language-text\">~/Library/LaunchAgents</code></li>\n<li><code class=\"language-text\">rm -f ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist</code></li>\n<li><code class=\"language-text\">launchctl remove homebrew.mxcl.mongodb</code></li>\n<li><code class=\"language-text\">pkill -f mongod</code>  Kill all the processes related to mongod</li>\n<li><code class=\"language-text\">brew uninstall mongodb</code></li>\n<li><code class=\"language-text\">rm -rf /opt/homebrew/var/mongodb</code> Data Directory</li>\n<li><code class=\"language-text\">brew cleanup -s mongodb-community</code></li>\n<li><code class=\"language-text\">brew cleanup --prune-prefix</code></li>\n</ol>\n<h2>Resource</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://docs.mongodb.com/manual/tutorial/manage-mongodb-processes/\nhttps://www.mongodb.com/community/forums/t/help-brew-mongodb-community-5-0-error-macos/125648\nhttps://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/\nhttps://rajanmaharjan.medium.com/uninstall-mongodb-macos-completely-d2a6d6c163f9</code></pre></div>","frontmatter":{"title":"在m1安装mongodb遇到的一些坑","date":"March 03, 2022","description":"some issues when installing mongodb on m1 chip MacBook","tags":["database","env setup"]}}},"pageContext":{"slug":"/mongodb-install-issue/","previous":{"fields":{"slug":"/dataBase-design-and-implementation-note/"},"frontmatter":{"title":"Database Design and Implementation Note","tags":["database","note"]}},"next":null}},"staticQueryHashes":["2841359383","3723978383"]}