<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[PPX Blog]]></title><description><![CDATA[PPX's blog]]></description><link>https://xichen1.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Thu, 03 Mar 2022 20:25:13 GMT</lastBuildDate><item><title><![CDATA[在m1安装mongodb遇到的一些坑]]></title><description><![CDATA[安装流程 install home brew    坑 Two ways to start service 根据mongodb文档, step 3和step 4中间还有一步 .  我们首先需要知道mongodb有两部分构成, server和client. 开启server…]]></description><link>https://xichen1.github.io/mongodb-install-issue/</link><guid isPermaLink="false">https://xichen1.github.io/mongodb-install-issue/</guid><pubDate>Thu, 03 Mar 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;安装流程&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;install home brew&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew tap mongodb/brew&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew install mongodb-community@5.0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew services list&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;坑&lt;/h2&gt;
&lt;h3&gt;Two ways to start service&lt;/h3&gt;
&lt;p&gt;根据&lt;a href=&quot;https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/&quot;&gt;mongodb文档&lt;/a&gt;, step 3和step 4中间还有一步 &lt;code class=&quot;language-text&quot;&gt;brew services start mongodb-community@5.0&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;我们首先需要知道mongodb有两部分构成, server和client. 开启server的命令为 &lt;code class=&quot;language-text&quot;&gt;mongod (other parameters...)&lt;/code&gt;, 开启client的命令为&lt;code class=&quot;language-text&quot;&gt;mongo&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;而官网所说的&lt;code class=&quot;language-text&quot;&gt;brew services start mongodb-community@5.0&lt;/code&gt; 其实会直接运行default mongod command. 而默认的server db存储位置为&lt;code class=&quot;language-text&quot;&gt;/data/db&lt;/code&gt;.  &lt;code class=&quot;language-text&quot;&gt;/&lt;/code&gt; 是mac的read-only space, 我们不可以在这里mkdir, 而他本来就没有/data/db这个folder, 所以我们运行官网给出的&lt;code class=&quot;language-text&quot;&gt;brew services start mongodb-community@5.0&lt;/code&gt; 后再运行 &lt;code class=&quot;language-text&quot;&gt;brew services list&lt;/code&gt; 就会显示 3584 error.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e464eb4b23519c39af0c037bddccc085/8efc2/error.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 22.972972972972975%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKElEQVQY0z2Q207CQBiE+wxAz90ewFpIhAi2WMqhSBE5KQlc+Bhe+lo+ij6M15+7JfFispM/M//Mv9rv9zs/Xyf8XoT/2MN7iIl7CWW55G4wIJ9MmM7ntDsdxnlOXhT4QYBl29iOc4V7fS0J7fPjxPmQYdgWTiBwQg9XeIRRhCdEbQ7CEMd15VxgWhYtXafZatXckGhIrhuGXGijVZsjt90+jWYTy7IxTSkyzVqgxIoro4LreYzSlMHwnlGW1kE3cUw2HpN0u3VL7XI5k0qRaqIgfJ+w3f7nyqSEpjxRNV4UU9blE/vnF5IkqRcdjkdm8lsi6dPmZclmu2W3P5BmGcVsxuvbiVVVkcrkVbWuzzcsE+G4DI2Avi4Y6j4NeboKVq0XyyXb3Z4/89aVW7+m22gAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;error&quot;
        title=&quot;error&quot;
        src=&quot;/static/e464eb4b23519c39af0c037bddccc085/fcda8/error.png&quot;
        srcset=&quot;/static/e464eb4b23519c39af0c037bddccc085/12f09/error.png 148w,
/static/e464eb4b23519c39af0c037bddccc085/e4a3f/error.png 295w,
/static/e464eb4b23519c39af0c037bddccc085/fcda8/error.png 590w,
/static/e464eb4b23519c39af0c037bddccc085/8efc2/error.png 828w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;Fail to stop service&lt;/h3&gt;
&lt;p&gt;当使用&lt;code class=&quot;language-text&quot;&gt;brew services start mongodb-community@5.0&lt;/code&gt; 时我们可以用 &lt;code class=&quot;language-text&quot;&gt;brew services stop mongodb-community@5.0&lt;/code&gt; 停止server.&lt;/p&gt;
&lt;p&gt;当使用 &lt;code class=&quot;language-text&quot;&gt;mongod (other parameters..)&lt;/code&gt;时我们有两种方法停止server.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ctrl+C on the terminal which is running mongod&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;open a new terminal&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;type &lt;code class=&quot;language-text&quot;&gt;mongo&lt;/code&gt; and hit enter&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;use admin&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;db.shutdownServer()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;填坑&lt;/h2&gt;
&lt;p&gt;很简单, 不使用brew services start即可. 我们可以使用&lt;code class=&quot;language-text&quot;&gt;sudo mkdir -p /System/Volumes/Data/data/db&lt;/code&gt; 在可写区域创建好db储存的文件夹. 然后用&lt;code class=&quot;language-text&quot;&gt;sudo mongod --dbpath /System/Volumes/Data/data/db&lt;/code&gt; 指定server运行时的数据位置. 这时使用&lt;code class=&quot;language-text&quot;&gt;brew services list&lt;/code&gt; 则会显示service status started. 之后就可以打开另一个terminal开启client了!&lt;/p&gt;
&lt;p&gt;注意: 在做这些事前请确保没有正在运行的mongod(server service).&lt;/p&gt;
&lt;h2&gt;卸载流程&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;launchctl list | grep mongo&lt;/code&gt; to check the running mongo service&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist&lt;/code&gt; based on which file exists in &lt;code class=&quot;language-text&quot;&gt;~/Library/LaunchAgents&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;rm -f ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;launchctl remove homebrew.mxcl.mongodb&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pkill -f mongod&lt;/code&gt;  Kill all the processes related to mongod&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew uninstall mongodb&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;rm -rf /opt/homebrew/var/mongodb&lt;/code&gt; Data Directory&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew cleanup -s mongodb-community&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew cleanup --prune-prefix&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Resource&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;https://docs.mongodb.com/manual/tutorial/manage-mongodb-processes/
https://www.mongodb.com/community/forums/t/help-brew-mongodb-community-5-0-error-macos/125648
https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/
https://rajanmaharjan.medium.com/uninstall-mongodb-macos-completely-d2a6d6c163f9&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Database Design and Implementation Note]]></title><description><![CDATA[In this post, I will record the notes when reading the book Database design and implementation (Sciore 2020). It mainly includes the points…]]></description><link>https://xichen1.github.io/dataBase-design-and-implementation-note/</link><guid isPermaLink="false">https://xichen1.github.io/dataBase-design-and-implementation-note/</guid><pubDate>Sat, 09 Oct 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;In this post, I will record the notes when reading the book Database design and implementation (Sciore 2020). It mainly includes the points I feel important or unclear before reading the book. &lt;/p&gt;
&lt;p&gt;The current version starts from chapter 2 since chapter 1 is more like the environment and conclusion   content. So let’s start.&lt;/p&gt;
&lt;h2&gt;Chapter 2 JDBC&lt;/h2&gt;
&lt;h3&gt;Concepts&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Database engine:&lt;/em&gt;&lt;/strong&gt; database engine is the software which manages(create, update, delete) the database directly. It is a part of DBSM.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Database client application:&lt;/em&gt;&lt;/strong&gt; it is a software which calls the database engine’s APIs to manipulate the database.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;JDBC:&lt;/em&gt;&lt;/strong&gt; it is a set of formats which regulates how to write database engine’s APIs with Java. JDBC contains five interfaces: &lt;em&gt;Driver, Connection,Statement, ResultSet, and ResultSetMetadata&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Usually, the client application does not want to adapt to different format of engine API, instead it wants to use fixed APIs for several operations, like connecting to db, operating statement and receiving from database. So JDBC provides a regulation for all db engine - they must implement the interfaces to provide the required features.&lt;/p&gt;
&lt;h3&gt;Connect to database with JDBC&lt;/h3&gt;
&lt;p&gt;The Driver interface in JDBC provides the method to connect client and database(connect). &lt;/p&gt;
&lt;p&gt;It accepts the protocol of connection(who connects to who), location of the server(ip, path), and other arguments(authentication, create new or not).&lt;/p&gt;
&lt;h4&gt;Vendor-specific code in client program&lt;/h4&gt;
&lt;p&gt;Notice, even though JDBC provides the common format for all db engines, there is still vendor-specific command to call in JDBC client. The different db engines provide different Driver types, and to connect to server, the client must use those different Drivers. Also, when connecting to db, different engines require different connection string (to specify different configs). In this case, the Drive and the connection string in client may differ for different engines.&lt;/p&gt;
&lt;p&gt;Because of the different types of Driver, in client program, it needs to import the engine specified Driver class.&lt;/p&gt;
&lt;h4&gt;Close a connection&lt;/h4&gt;
&lt;p&gt;The connection class provides a method close() which allows to close the connection between client and server.&lt;/p&gt;
&lt;h3&gt;Exception Handle&lt;/h3&gt;
&lt;p&gt;There are various exception might happen during running database, different db engine usually handle them in different ways. So to regulate the exception showing for client, JDBC provides a exception class &lt;strong&gt;&lt;em&gt;SQLException&lt;/em&gt;&lt;/strong&gt;, it wraps the db engine’s personal exception and provides the client a error message according to the wrapped exception.&lt;/p&gt;
&lt;h4&gt;Try with resource syntax&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Connection&lt;/span&gt; conn &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; d&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this example, it creates a connection resource in try parentheses, when it reaches the end of try block, no matter it has a exception or finishing the execution, java will close the connection resource implicitly which avoids the resource leak.&lt;/p&gt;
&lt;h3&gt;Executing SQL statements&lt;/h3&gt;
&lt;p&gt;After the connection is created, the connection class can use the method createStatement() to create a Statement object. The Statement has three basic methods — &lt;/p&gt;
&lt;p&gt;executeQuery, executeUpdate and close. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;executeQuery’s argument is a double quoted SQL query, and returns a ResultSet object.&lt;/li&gt;
&lt;li&gt;executeUpdate’s argument is a double quoted SQL UPDATE query, and returns a ResultSet object.&lt;/li&gt;
&lt;li&gt;executeUpdate method returns the number of records that were updated.&lt;/li&gt;
&lt;li&gt;executeQuery method returns a ResultSet object which represents the output of the query.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;RestultSet&lt;/h4&gt;
&lt;p&gt;It is a object used to store each row of the output after executing the SQL query. In the beginning it points to the position before the first row of output records. By calling the method  next(), it can move one row forward. When pointing to each, the client can use some methods to call that row’s record. When next() method returns False, it’s pointing to the end of the output records.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// connection&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; qry &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;select ...&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;ResultSet&lt;/span&gt; rs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; stmt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;executeQuery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;qry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// process the record&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// getString(fieldName)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// getInt(fieldName)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;ResultSetMetaData&lt;/h3&gt;
&lt;p&gt;The interface ResultSetMetaData of JDBC can be used to record the information of each column (eg name, type, data size of each field in one table). It is the output of method &lt;code class=&quot;language-text&quot;&gt;ResultSet.getMetaData();&lt;/code&gt; &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// i is the index of column, starting from 1&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// use a loop to get all columns&apos; infor&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; md&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getColumnName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; md&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getColumnDisplaySize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; typecode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; md&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getColumnType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Whole process for a client to execute one SQL statement&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Accept one connection string from the input, determine it’s connecting to server or Embedded by checking if there is ”//” in connection string. Then create the proper Driver.&lt;/li&gt;
&lt;li&gt;Using the Driver to create a connection, by calling &lt;code class=&quot;language-text&quot;&gt;Driver.connect(connStr, null)&lt;/code&gt; , and put this call in try statement to prevent the resource leak.&lt;/li&gt;
&lt;li&gt;Initializing a Statement object, to prepare for executing statement later.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Inside the try block, using while loop to accept each line of statement, operating bases on the start str of the statement:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;if starting with exit, close the connection, quit the process&lt;/li&gt;
&lt;li&gt;if starting with “select”&lt;/li&gt;
&lt;li&gt;Using the Statement object and query statement, calling &lt;code class=&quot;language-text&quot;&gt;stmt.executeQuery(SQLStatment)&lt;/code&gt; and get the ResultSet object.&lt;/li&gt;
&lt;li&gt;Using loop and proper methods to get each column’s info(type, name, size)&lt;/li&gt;
&lt;li&gt;Using loop and ResultSet.next() to get each row’s record.&lt;/li&gt;
&lt;li&gt;if starting with other str&lt;/li&gt;
&lt;li&gt;Using the Statement object and query statement, calling &lt;code class=&quot;language-text&quot;&gt;stmt.updateQuery(SQLStatment)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Output how many records are updated&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Transaction&lt;/h3&gt;
&lt;h4&gt;Autocommit or Not&lt;/h4&gt;
&lt;p&gt;A Transaction is a set of work (SQL statements). When a set of work is completed successfully, the database engine will commit the change to the db. When any work inside the transaction fails, the engine will fail all work of this transaction and roll back the db’s state.&lt;/p&gt;
&lt;p&gt;In the base JDBC implementation, the process implemented in a way called Autocommit, each statement is a transaction, so the engine will not commit multiple changes in one transaction. &lt;/p&gt;
&lt;p&gt;This is reasonable since each transaction creates a lock which prevents the other transaction from committing, and executing one statement in each transaction will shorten the waiting time for the other transactions. But we may want the transaction to contain multiple work sometimes:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;When we need more than one statement active. For example, if we need the result of the first statement to operate the second statement. If we release the lock after executing the first statement, the result might be different when executing the second statement. So we need to lock the resource during the whole process of executing these two statements.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;When we need to execute more than one statement at the same time. For example, swapping two records:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;String cmd1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;update SECTION set Prof= &apos;brando&apos; where SectId = 43&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
String cmd2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;update SECTION set Prof= &apos;einstein&apos; where SectId = 53&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we commit the db after the first stmt, two names will be same and this is an undesirable result.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Because each stmt is independent, it might be inconvenient if we want to do a batch of work but it crashes in the middle of work. We have difficulty to determine which operations are successful and which failed. It’s better to put them in one transaction and let them fail or succeed together.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;Solution&lt;/h4&gt;
&lt;p&gt;To allow custom handle of commit/transaction, JDBC provides three APIs of Connection object for client.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setAutoCommit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; ac&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SQLException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By calling &lt;code class=&quot;language-text&quot;&gt;setAutoCommit(False)&lt;/code&gt;, it closes the engine’s one stmt each transaction strategy, giving the client rights to decide when to commit or rollback. Then the client can decide the time to complete the transaction by itself.&lt;/p&gt;
&lt;p&gt;After all statements in one desired transaction is finished, the client can call commit(), and the client can call rollback() in catch block of the try statement of creating the connection, so that if any error happens, it can roll back the db.&lt;/p&gt;
&lt;h3&gt;Handle concurrency&lt;/h3&gt;
&lt;p&gt;The concurrency in database is similar as it in operating system — db engines handle the one transaction(process) first, stop it and move to handle another transaction(process), and move among different transactions. Similar as CPU, db engines cannot handle multiple transaction at the same time, instead, it stops one transaction, stores its states, and move to the other transactions. With the fast speed, it creates an illusion that it’s handling multiple transaction at same time.&lt;/p&gt;
&lt;p&gt;This leads to problem, because if part of one transaction is finished, and another transaction start to executing the stmts, it will use the wrong, uncommitted records created by the first transaction.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[MIT 6.828 Lab 1 Note]]></title><description><![CDATA[Introduction From today, I am going to share my experience in learning, implementing labs of MIT 6.828 in my blog. My background knowledge…]]></description><link>https://xichen1.github.io/6.828-lab1-note/</link><guid isPermaLink="false">https://xichen1.github.io/6.828-lab1-note/</guid><pubDate>Tue, 22 Dec 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;From today, I am going to share my experience in learning, implementing labs of MIT 6.828 in my blog.&lt;/p&gt;
&lt;p&gt;My background knowledge includes: C, computer architecture, RISC-V.&lt;/p&gt;
&lt;p&gt;I am going to use 2018 version material simply because there are most amount of resource about this version online.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://pdos.csail.mit.edu/6.828/2018/schedule.html&quot;&gt;Course homepage&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://pdos.csail.mit.edu/6.828/2018/labs/lab1/&quot;&gt;lab1 page&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Environment setup&lt;/h2&gt;
&lt;p&gt;First clone the course git repo, &lt;a href=&quot;https://pdos.csail.mit.edu/6.828/2018/jos.git&quot;&gt;Course Git reop&lt;/a&gt;. Then install toolchain, &lt;a href=&quot;https://pdos.csail.mit.edu/6.828/2018/tools.html&quot;&gt;install instruction&lt;/a&gt;. Note that if the Compiler Toolchain is already installed, the only thing needs to be installed is QEMU emulator. Next, lets compile the files in the Git repo.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sudo apt install gcc-multilib # if you are not under 32 bit environment
cd lab
make&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then type&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;make qemu&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We will successfully start JOS in the QEMU emulator. Now we boot the template OS and finish the setup of environment and lets take a look at the memory distribution in 32-bit machine.&lt;/p&gt;
&lt;h2&gt;PC’S address space &amp;#x26; PC start up process&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/55d5a040844645afe803a9725e8cac59/e85cb/pcmemory.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 120.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC00lEQVQ4y41Vi3KjMAzM///hdabtJeEZMG8MGIhuV0Aa0vQaz6g86iyrXUk+yPUqwzBoOOdkmiYN3m/vx3GUqqokNYmYBJEaqZtGLnEkdd0I1xU4XIfrPEnXtjLjeRydpGkqcRQrIDe1bYf7UbquA0itezvbSd/3kmeZWLzfA06j9NZKnpfy9/NT/DCQP29vcjyepAc7a3tl/L+1gd0A+VWuqsjlcrlIgrS6ftB3ZDiO0+2Hz2LHUK6z1NCHWlgwZWqMFh+p6xra1TLP129MfloH/qHwBGA0EJuxPfN/9+x+B8QmAhRlqU6S1cKs0ndkfp/WI/Bj+qqhBaC6DGeVIUCGwekPmsb+quED4KQuc824z42RDOHcArK4PMurC3U4i20bLZFnhd22Vq9FUYp39lAFiUqR5Ub8IJI0SSFLpbWbJGZhyJT3dfV1rymjsJk2q0A7Cg3g3IBq6PV5I8AG0E6xakqt5VMWhZpS4MpN7QuFvU95YusRsLrpV1YlUotl6F/vlC9TVoY/Vdji8gjQUfuXwdT5bhsc96A3U5g/U83Q8GWx1CQ3b6ZUYO0Hvvi+J8e/R/R+LmEQ6NR5mDaztGsdlnDP9wNJ0M9Znq0M20VLdA1l4MiKo0glMphMIdwdnLuBqoZD3ykjDgWCpph3FwXN1UkC9tizsC90bDX4AFlnWb5L+zCv4ys1mXx+vIOhL1F0kY/3D4nBiC6zbCZo7daBq9qByKKj27WmptzZVr+YgmGRg0FeaA+z1r40rOTsnVTDE2YlmVGa0+msTXEHiLIBQwKGYYS0UzmvHcEJTsBFw0Y1pH5RGEKaCqBGoniZ7nvA9Qh4Vl/WdvoDzkgCGJMijJpFPQ30dPcabhObeEyXhniBpwZsE/uV4fDtkJpAkeNLhXbDekixRpdDigXNdiQ7Bp8fB68yXI7R/naMMsb1en+80pQAzH3vLB6MYAc9Oxb+AbbxTxK8dKi0AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;PC&amp;#39;s physical address&quot;
        title=&quot;PC&amp;#39;s physical address&quot;
        src=&quot;/static/55d5a040844645afe803a9725e8cac59/e85cb/pcmemory.png&quot;
        srcset=&quot;/static/55d5a040844645afe803a9725e8cac59/12f09/pcmemory.png 148w,
/static/55d5a040844645afe803a9725e8cac59/e4a3f/pcmemory.png 295w,
/static/55d5a040844645afe803a9725e8cac59/e85cb/pcmemory.png 480w&quot;
        sizes=&quot;(max-width: 480px) 100vw, 480px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The important part for PC start up is only the lower 1MB part, because right now CPU is under Real mode and the only accessible memory is this part. In this part, the most important on is BIOS (basic IO system), because code in BIOS starts the normal PC start up. And the other part of this 1MB memory is mapped by peripherals, which means CPU can read/write the other part to manipulate peripherals.&lt;/p&gt;
&lt;h4&gt;An interesting history&lt;/h4&gt;
&lt;p&gt;The max memory 32-bit processor can handle is 4GB. So when the 64-bit processor came out, larger memory were used in PC. The modern PC usually put BIOS at the top of the memory, and to keep the backward compatibility for some old software, designer keeps a “hole” from 0x000A0000 to 0x00100000.&lt;/p&gt;
&lt;h3&gt;Use GDB to analyze the process of start up&lt;/h3&gt;
&lt;p&gt;Now open two terminals, move into the OS folder. In the first one, type&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;make qemu-nox-gdb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This line starts the emulator and waits for the connection of GDB. And in the second terminal, type&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;make gdb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This line starts GDB and connect it to the OS. The file .gdbinit configs GDB to debug the code executed in the boot of OS in QEMU.&lt;/p&gt;
&lt;h4&gt;Very first instruction&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;[f000:fff0]    0xffff0:	ljmp   $0x3630,$0xf000e05b&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is the first line appears after we connect GDB and OS. It shows where does the processor fetch the very first instruction and what that instruction is when we boot a PC.&lt;/p&gt;
&lt;p&gt;Under the real mode, address is in the form of (segment base : offset). So in the above line, in [f000:fff0], 0xf000 is segment base and 0xfff0 is offset. For 0x3630, 0xf000e05b, 0x3630 is segment base and 0xf000e05b is offset. The way to transfer this form into physical form is:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;phyAddr = 16 * segment + offset = 16 * CS + IP&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And after translating, this line means the professor fetch instruction from address 0xFFFF0, and instruction inside is a jump instruction, and the target address is 0xF004 435B.&lt;/p&gt;
&lt;p&gt;So there is several natural questions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Why did the designer put the very first instruction in this location (distance between here and end of BIOS is 0x100000 - 0xFFFF0 = 16 bytes)?&lt;/li&gt;
&lt;li&gt;Why don’t just put this instruction in the beginning of the BIOS?&lt;/li&gt;
&lt;li&gt;Considering it is a jump instruction, why not set the first instruction just at its target address?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The first two questions can be answered together. We have to consider that each PC company has their own BIOS code, user can add BIOS code too. Also, different company designs different length of BIOS boot code, so if the user wants to add code, the place to add is uncertain. However, if instead, we put user created code in the beginning of BIOS, it is more convenient to manage. So normally we put BIOS boot code in the end of BIOS part.&lt;/p&gt;
&lt;p&gt;For the last question, because different PC has different length of BIOS boot code, for example, if this code is 1KB, the start address is 0x100000 - 0x400 = 0xFFC00. If the code is 2KB, the start address is 0xFF800. And it is not a good practice to adjust the first instruction address in each PC. So the rule is put a jump instruction at 0xFFFF0 and the target is defined by each company.&lt;/p&gt;
&lt;h2&gt;TO BE CONTINUE&lt;/h2&gt;</content:encoded></item><item><title><![CDATA[Intro to Express]]></title><description><![CDATA[What is Express? Express is a Web framework based on node.js. It provides ways to recognize and respond to http request through Middleware…]]></description><link>https://xichen1.github.io/intro-to-express/</link><guid isPermaLink="false">https://xichen1.github.io/intro-to-express/</guid><pubDate>Sun, 02 Aug 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h3&gt;What is Express?&lt;/h3&gt;
&lt;p&gt;Express is a Web framework based on node.js. It provides ways to recognize and respond to http request through Middleware and Router.&lt;/p&gt;
&lt;h3&gt;Start&lt;/h3&gt;
&lt;p&gt;To start using Express, we need to import express and create one instance using express(). To test the application, we also need a port and use the instance to listen to the port. This port can replace the real root dir and simulate the root page of the application.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;const express = require(&amp;#39;express&amp;#39;)
const app = express()
const port = 3000

app.listen(port, () =&amp;gt; {
  console.log(`Example app listening at http://localhost:${port}`)
})&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Routing&lt;/h3&gt;
&lt;p&gt;Routing is the way to determining the response to the particular request. A route needs one method (GET, POST, PUT), one path and one or more handler callback function(s). An example is:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;app.get(&amp;#39;/&amp;#39;, function(req, res))&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The path represents the location of the request requires to change. The req object represents the HTTP request and res represents the HTTP response that the app will send when it receive a request.&lt;/p&gt;
&lt;h3&gt;Serving static files&lt;/h3&gt;
&lt;p&gt;The work of the web application is the process of requests and responses. For example, when we open the main page of one web app, we send a request to GET index.html as a client. If such file is right in local dir, we can use express to get it directly as a static file. For example, if all our front-end file is in the dir path ’~/build’, we can use&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;app.use(express.static(&amp;#39;build&amp;#39;))&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, whenever the server receives the request to GET something, it will go to the build folder and look for the responded file. If there is no such file locally, Express will then go to the connected database to look for it through some condition (model schema).&lt;/p&gt;
&lt;h3&gt;Middleware&lt;/h3&gt;
&lt;p&gt;Middleware functions are functions that have access to req, res and the ‘next’ function. There are five types of middleware. The next function can assign the direction of the flow. If the middleware does not end the req, res cycle, a next() function is required to continue the flow into the next middleware function.&lt;/p&gt;
&lt;h4&gt;Application-level middleware&lt;/h4&gt;
&lt;p&gt;This middleware includes two methods, app.use() and app.METHOD().&lt;/p&gt;
&lt;p&gt;If the app.use() only has one argument, the callback function, it will be executed every time the app receives a request. If there is the path in the arguments, the function will executed every time the app receives a request on the path.&lt;/p&gt;
&lt;h4&gt;Router-level middleware&lt;/h4&gt;
&lt;p&gt;The router middleware needs to be bound to an instance of “require(‘express’).Router()“. It can be seen as a middleware between app middleware and router. The RLM can only perform middleware and routing functions. After we bound the RLM to some routers, we can execute app.use(path, router_instance) and that will execute the corresponding method we bound to RLM instance.&lt;/p&gt;
&lt;h4&gt;Error-handling middleware&lt;/h4&gt;
&lt;p&gt;Whenever we catch some error in the middleware and route handlers, we need to pass the error to Express through next(error). The error will then be passed into the build-in error handler. We can also write error handlers and this is the error-handling middleware.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;app.use(function(err, req, res, next) {})&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can handle different errors inside the function, and in the end, we can continue to use next(error) to pass the error we cannot handle now to Express.&lt;/p&gt;
&lt;h3&gt;Handle unknown endpoints&lt;/h3&gt;
&lt;p&gt;If the client send an request which is not defined in any middleware, we need to handle it by responding a 404. The way to handle writing and adding an unknown endpoint middleware after all app-level middleware and router-level middleware and before Error-handling middleware.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;app.use((request, response) =&amp;gt; {
    response.status(404).send({ error: &amp;#39;unknown endpoint&amp;#39; })
})&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To learn more about Express, view &lt;a href=&quot;https://expressjs.com/en/5x/api.html&quot;&gt;API reference&lt;/a&gt;.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Hello World]]></title><description><![CDATA[Hello World! This is my first post on my blog!]]></description><link>https://xichen1.github.io/hello-world/</link><guid isPermaLink="false">https://xichen1.github.io/hello-world/</guid><pubDate>Mon, 15 Jun 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Hello World!&lt;/h2&gt;
&lt;p&gt;This is my first post on my blog!&lt;/p&gt;</content:encoded></item></channel></rss>